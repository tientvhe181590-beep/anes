spring:
  application:
    name: anes-server
  profiles:
    active: dev

  jpa:
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 2000ms
      connect-timeout: 2000ms

  flyway:
    enabled: true
    locations: classpath:db/migration

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: health
  endpoint:
    health:
      show-components: always

anes:
  firebase:
    enabled: ${FIREBASE_AUTH_ENABLED:false}
    service-account-path: ${FIREBASE_SERVICE_ACCOUNT_PATH:}

  jwt:
    secret: ${JWT_SECRET:default-dev-secret-change-in-production-must-be-at-least-256-bits-long-for-hs256}
    access-token-expiration: 3600000       # 1 hour in ms
    refresh-token-expiration: 2592000000   # 30 days in ms

  ai:
    provider: gemini
    model: gemini-2.0-flash
    api-key: ${GEMINI_API_KEY:}
    temperature: 0.7
    max-output-tokens: 2048
    rate-limit:
      free-tier: 10
      premium-tier: 60

  cors:
    allowed-origin: ${ANES_CORS_ORIGIN:http://localhost:5173}

  posthog:
    api-key: ${POSTHOG_API_KEY:}
    host: ${POSTHOG_HOST:https://us.i.posthog.com}

  redis:
    enabled: ${ANES_REDIS_ENABLED:true}

  rate-limit:
    ip-limits:
      auth:
        max-requests: 20
        window-seconds: 900
        block-seconds: 900
      legacy-login:
        max-requests: 10
        window-seconds: 900
        block-seconds: 1800
      register:
        max-requests: 5
        window-seconds: 3600
        block-seconds: 3600
    user-limits:
      ai:
        max-requests: 10
        window-seconds: 60
        block-seconds: 60
      password-change:
        max-requests: 3
        window-seconds: 3600
        block-seconds: 3600
      sync-push:
        max-requests: 30
        window-seconds: 60
        block-seconds: 60
